{
  "version": 3,
  "sources": ["../../../src/js/modules/analytics.mjs"],
  "sourcesContent": ["// Minimal analytics module with consent and sampling (opt-in)\r\nimport { log, createCorrelationId } from '../utils/logger.mjs';\r\n\r\nlet enabled = false;\r\nlet consentRequired = true;\r\nlet sampleRate = 1.0;\r\n\r\nexport function initAnalytics(opts = {}) {\r\n  enabled = Boolean(opts.enabled);\r\n  consentRequired = opts.consentRequired !== false;\r\n  sampleRate = Number.isFinite(opts.sampleRate) ? Math.max(0, Math.min(1, opts.sampleRate)) : 1.0;\r\n}\r\n\r\nfunction hasConsent() {\r\n  try {\r\n    const v = (localStorage && localStorage.getItem('consent_analytics')) || '';\r\n    return String(v).toLowerCase() === 'granted';\r\n  } catch { return false; }\r\n}\r\n\r\nfunction sampledIn() {\r\n  if (sampleRate >= 1) return true;\r\n  return Math.random() < sampleRate;\r\n}\r\n\r\nexport function track(eventName, properties = {}) {\r\n  if (!enabled) return false;\r\n  if (consentRequired && !hasConsent()) return false;\r\n  if (!sampledIn()) return false;\r\n  const id = createCorrelationId();\r\n  log('info', 'analytics_event', { id, event: eventName, props: properties });\r\n  return true;\r\n}\r\n\r\n"],
  "mappings": "2EAGA,IAAIA,EAAU,GACVC,EAAkB,GAClBC,EAAa,EAEV,SAASC,EAAcC,EAAO,CAAC,EAAG,CACvCJ,EAAU,EAAQI,EAAK,QACvBH,EAAkBG,EAAK,kBAAoB,GAC3CF,EAAa,OAAO,SAASE,EAAK,UAAU,EAAI,KAAK,IAAI,EAAG,KAAK,IAAI,EAAGA,EAAK,UAAU,CAAC,EAAI,CAC9F,CAEA,SAASC,GAAa,CACpB,GAAI,CACF,IAAMC,EAAK,cAAgB,aAAa,QAAQ,mBAAmB,GAAM,GACzE,OAAO,OAAOA,CAAC,EAAE,YAAY,IAAM,SACrC,OAAQ,GAAE,MAAO,EAAO,CAC1B,CAEA,SAASC,GAAY,CACnB,OAAIL,GAAc,EAAU,GACrB,KAAK,OAAO,EAAIA,CACzB,CAEO,SAASM,EAAMC,EAAWC,EAAa,CAAC,EAAG,CAGhD,GAFI,CAACV,GACDC,GAAmB,CAACI,EAAW,GAC/B,CAACE,EAAU,EAAG,MAAO,GACzB,IAAMI,EAAKC,EAAoB,EAC/B,OAAAC,EAAI,OAAQ,kBAAmB,CAAE,GAAAF,EAAI,MAAOF,EAAW,MAAOC,CAAW,CAAC,EACnE,EACT",
  "names": ["enabled", "consentRequired", "sampleRate", "initAnalytics", "opts", "hasConsent", "v", "sampledIn", "track", "eventName", "properties", "id", "createCorrelationId", "log"]
}
