import{a as Ue,b as B}from"./chunks/chunk-TXIFLR42.js";import"./chunks/chunk-72ZECFVW.js";function He(){try{let e=document.createElement("style");window&&window.__CSP_NONCE__&&e.setAttribute("nonce",window.__CSP_NONCE__),e.textContent=`
      /* Miniatura del carrito (mantener consistente con base/enhanced CSS) */
      .cart-item-thumb { width: 100px; height: 100px; flex-shrink: 0; }
      .cart-item-thumb img, .cart-item-thumb-img { width: 100%; height: 100%; object-fit: cover; border-radius: 0.25rem; }

      /* Contornos de enfoque claros para accesibilidad */
      .navbar .nav-link:focus,
      .navbar .dropdown-item:focus {
        outline: 2px solid var(--primary-color);
        outline-offset: 2px;
      }

      /* Espaciado entre botones en el offcanvas del carrito */
      #cartOffcanvas .offcanvas-body > .btn + .btn { margin-top: 0.5rem !important; }
    `,document.head.appendChild(e)}catch(e){console.warn("[modules/enhancements] injectEnhancementStyles error:",e)}}function We(){try{document.addEventListener("keydown",t=>{t.key==="Tab"&&document.body.classList.add("keyboard-navigation")}),document.addEventListener("mousedown",()=>{document.body.classList.remove("keyboard-navigation")});let e=document.createElement("style");window&&window.__CSP_NONCE__&&e.setAttribute("nonce",window.__CSP_NONCE__),e.textContent=".keyboard-navigation *:focus { outline: 2px solid var(--primary-color); outline-offset: 2px; }",document.head.appendChild(e)}catch(e){console.warn("[modules/a11y] setupNavigationAccessibility error:",e)}}function Vt(e){if(!e)return[];let t=["a[href]","area[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])','[contenteditable="true"]'];return Array.from(e.querySelectorAll(t.join(","))).filter(n=>{if(!(n instanceof HTMLElement))return!1;let r=window.getComputedStyle(n);return r.visibility!=="hidden"&&r.display!=="none"})}function Ve(){try{let b=function(){u(),r&&typeof r.focus=="function"?r.focus():n&&typeof n.focus=="function"&&n.focus()},e=document.getElementById("cartOffcanvas");if(!e)return;let t=e.querySelector("#cartOffcanvasLabel"),n=document.getElementById("cart-icon"),r=null,a=!1,d=g=>{if(g.key==="Escape"&&e.dataset.bsFallback==="1"){g.preventDefault(),e.classList.remove("show"),e.setAttribute("aria-hidden","true"),b();return}if(g.key!=="Tab")return;let E=Vt(e);if(!E.length){g.preventDefault();return}let S=E[0],P=E[E.length-1],z=document.activeElement;g.shiftKey?(z===S||!e.contains(z))&&(g.preventDefault(),P.focus()):z===P&&(g.preventDefault(),S.focus())},m=()=>{a||(e.addEventListener("keydown",d),a=!0)},u=()=>{a&&(e.removeEventListener("keydown",d),a=!1)},p=()=>{t instanceof HTMLElement&&typeof t.focus=="function"?t.focus():e.focus()};e.addEventListener("show.bs.offcanvas",()=>{r=document.activeElement instanceof HTMLElement?document.activeElement:null,m()}),e.addEventListener("shown.bs.offcanvas",()=>{p()}),e.addEventListener("hidden.bs.offcanvas",()=>{b()}),e.addEventListener("click",g=>{let E=g.target instanceof HTMLElement?g.target:null;!E||!E.closest('[data-bs-dismiss="offcanvas"]')||e.dataset.bsFallback==="1"&&(g.preventDefault(),e.classList.remove("show"),e.setAttribute("aria-hidden","true"),b())})}catch(e){console.warn("[modules/a11y] setupCartOffcanvasAccessibility error:",e)}}function Ke(){try{"loading"in HTMLImageElement.prototype&&document.querySelectorAll("img:not([loading])").forEach(e=>{e.loading="lazy"})}catch(e){console.warn("[modules/perf] setupPerformanceOptimizations error:",e)}}var H="__PRODUCT_DATA__";function Kt(){try{if(typeof window=="undefined")return null;let e=window[H];if(e&&Array.isArray(e.products))return e.products}catch(e){console.warn("[modules/seo] Unable to read shared product data:",e)}return null}function Gt(e,t={}){var r,a;if(typeof window=="undefined"||!Array.isArray(e))return;let n=window[H]||{};window[H]={...n,products:e,version:(a=(r=t.version)!=null?r:n.version)!=null?a:null,updatedAt:t.updatedAt||Date.now(),source:t.source||n.source||"seo"}}function Ge(e=[]){let t={};return e.forEach(n=>{let r=n.id||String(n.name)+"-"+String(n.category);t[r]=n}),t}function Ye(){if(typeof window=="undefined")return;let e=window[H]||{};e.structuredDataInjected||(window[H]={...e,structuredDataInjected:!0})}async function Yt(){try{let e=Kt();if(e)return Ge(e);let t=localStorage.getItem("productDataVersion"),n=t?`/data/product_data.json?v=${encodeURIComponent(t)}`:"/data/product_data.json",r=await fetch(n,{cache:"no-store",headers:{Accept:"application/json"}});if(!r.ok)return null;let a=await r.json(),d=Array.isArray(a==null?void 0:a.products)?a.products:Array.isArray(a)?a:[];return Gt(d,{version:(a==null?void 0:a.version)||t||null,source:"seo-fallback"}),Ge(d)}catch(e){return console.error("[modules/seo] Error loading product data:",e),null}}async function Qe(){try{if(document.querySelector('script[type="application/ld+json"]')){Ye();return}let e=typeof window!="undefined"?window[H]:null;if(e!=null&&e.structuredDataInjected)return;let t=await Yt();if(!t)return;let r=Object.values(t).slice(0,20).map(m=>({"@type":"Product",name:m.name,image:m.image_path,description:m.description,brand:m.brand||"Gen\xE9rico",offers:{"@type":"Offer",price:m.price,priceCurrency:"CLP",availability:m.stock?"https://schema.org/InStock":"https://schema.org/OutOfStock"}})),a={"@context":"https://schema.org","@graph":[{"@type":"Store",name:"El Rinc\xF3n de \xC9bano",image:"https://elrincondeebano.com/assets/images/web/logo.webp",description:"Un minimarket en la puerta de tu departamento",address:{"@type":"PostalAddress",addressCountry:"CL"},telephone:"+56951118901",url:"http://www.elrincondeebano.com/",contactPoint:{"@type":"ContactPoint",telephone:"+56-951118901",contactType:"customer service"}},...r]},d=document.createElement("script");d.type="application/ld+json",window&&window.__CSP_NONCE__&&d.setAttribute("nonce",window.__CSP_NONCE__),d.textContent=JSON.stringify(a),document.head.appendChild(d),Ye()}catch(e){console.error("[modules/seo] Error generating structured data:",e)}}function Je(){try{if(!document.querySelector('link[rel="canonical"]')){let e=document.createElement("link");e.rel="canonical",e.href=location.origin+location.pathname,document.head.appendChild(e)}if(!document.querySelector('meta[name="description"]')){let e=document.createElement("meta");e.name="description",e.content="El Rinc\xF3n de \xC9bano - Minimarket con delivery instant\xE1neo.",document.head.appendChild(e)}}catch(e){console.warn("[modules/seo] injectSeoMetadata error:",e)}}function Ze(){try{if(!document.querySelector('link[rel="manifest"]')){let e=document.createElement("link");e.rel="manifest",e.href="/app.webmanifest",document.head.appendChild(e)}}catch(e){console.warn("[modules/pwa] injectPwaManifest error:",e)}}function Xe(){var e;try{(e=window==null?void 0:window.console)!=null&&e.debug&&console.debug("[modules/checkout] setupCheckoutProgress: no-op")}catch(t){}}var ae=new WeakMap,ge=new Set,tt=new Set,Qt=typeof window!="undefined"&&typeof window.requestAnimationFrame=="function"?window.requestAnimationFrame.bind(window):e=>setTimeout(e,16),nt=typeof window!="undefined"&&typeof window.cancelAnimationFrame=="function"?window.cancelAnimationFrame.bind(window):e=>clearTimeout(e);function Jt(e){if(typeof e.composedPath=="function")return e.composedPath();let t=[],n=e.target;for(;n;)t.push(n),n=n.parentNode;return typeof window!="undefined"&&t.push(window),t.push(document),t}function Zt(e,t,n){var d;if(!e)return`${t}-${n}`;if(typeof e.id=="string"&&e.id.trim().length>0)return`id:${e.id}`;let r=(d=e.dataset)==null?void 0:d.dropdownId;if(r)return r;let a=`${t}:${n}`;return e.dataset&&(e.dataset.dropdownId=a),a}function ye(e,t){let{toggle:n,menu:r,dropdownNode:a}=e;n.classList.toggle("show",t),n.setAttribute("aria-expanded",t?"true":"false"),r&&r.classList.toggle("show",t),a&&a.classList.toggle("show",t)}function J(e){e.expandedId=null,e.toggles.forEach(t=>{ye(t,!1)})}function Xt(e){if(e.outsideListenerInstalled)return;e.outsideListenerInstalled=!0;let t=!1,n=()=>{document.addEventListener("pointerdown",e.onPointerDownOutside,!0),t=!0};e.outsideListenerCleanup=()=>{e.installTimer!==null&&(clearTimeout(e.installTimer),e.installTimer=null),t&&(document.removeEventListener("pointerdown",e.onPointerDownOutside,!0),t=!1),e.outsideListenerInstalled=!1},e.installTimer=setTimeout(()=>{e.installTimer=null,n()},0)}function me(e,t,n){if(!(e.button!==void 0&&e.button!==0)){if(t.preventNavigation&&n.toggle.tagName==="A"&&e.preventDefault(),e.stopPropagation(),typeof e.stopImmediatePropagation=="function"&&e.stopImmediatePropagation(),t.justOpened=!0,t.justOpenedFrame!==null&&nt(t.justOpenedFrame),t.justOpenedFrame=Qt(()=>{t.justOpened=!1,t.justOpenedFrame=null}),Xt(t),t.expandedId===n.id){J(t);return}J(t),ye(n,!0),t.expandedId=n.id}}function en(e,t,n){let r=e.key;r==="Enter"||r===" "||r==="Spacebar"?(e.preventDefault(),me(e,t,n)):r==="Escape"&&(J(t),n.toggle.focus())}function et(){return typeof performance!="undefined"&&typeof performance.now=="function"?performance.now():Date.now()}function tn(e,t){let n=e.closest(".dropdown"),r=n==null?void 0:n.querySelector(".dropdown-menu"),a=Zt(e,"auto",t),d={toggle:e,menu:r,dropdownNode:n,id:a,lastPointerTime:0};return r&&!r.id&&(r.id=`${a}-menu`),r&&e.setAttribute("aria-controls",r.id),d}function nn(e){let t={container:e,toggles:[],expandedId:null,justOpened:!1,justOpenedFrame:null,outsideListenerInstalled:!1,outsideListenerCleanup:null,installTimer:null,onPointerDownOutside:null,preventNavigation:!0};return t.onPointerDownOutside=r=>{t.justOpened||Jt(r).includes(t.container)||J(t)},Array.from(e.querySelectorAll(".dropdown-toggle")).forEach((r,a)=>{if(r.dataset.menuControllerBound==="1")return;r.dataset.menuControllerBound="1";let d=tn(r,a);t.toggles.push(d);let m=b=>{d.lastPointerTime=et(),me(b,t,d)},u=b=>{if(et()-(d.lastPointerTime||0)<250){b.preventDefault(),b.stopPropagation(),typeof b.stopImmediatePropagation=="function"&&b.stopImmediatePropagation();return}me(b,t,d)},p=b=>en(b,t,d);r.addEventListener("pointerdown",m),r.addEventListener("click",u),r.addEventListener("keydown",p),d.cleanup=()=>{r.removeEventListener("pointerdown",m),r.removeEventListener("click",u),r.removeEventListener("keydown",p),delete r.dataset.menuControllerBound}}),ae.set(e,t),ge.add(e),tt.add(t),t.toggles.length===0?(rn(t),null):t}function rn(e){e&&(e.toggles.forEach(t=>{var n;ye(t,!1),(n=t.cleanup)==null||n.call(t)}),e.toggles=[],J(e),e.outsideListenerCleanup&&(e.outsideListenerCleanup(),e.outsideListenerCleanup=null),e.justOpenedFrame!==null&&(nt(e.justOpenedFrame),e.justOpenedFrame=null),e.container&&(ae.delete(e.container),ge.delete(e.container)),tt.delete(e))}function rt({container:e}={}){if(typeof document=="undefined")return;let t;if(e)t=[e];else{let n=Array.from(document.querySelectorAll("#navbar-container"));t=n.length>0?n:Array.from(document.querySelectorAll(".navbar, nav"))}t.forEach(n=>{if(!(n instanceof HTMLElement)||n.querySelectorAll(".dropdown-toggle").length===0||ae.get(n))return;nn(n)||(ae.delete(n),ge.delete(n))})}var ot=!1,it=new Map,he=null,we=null;function at(e){if(e&&typeof e=="object"){if(e.default)return e.default;let t=Object.keys(e);if(t.length===1)return e[t[0]]}return e}function st(e,t){return!e||!t?null:typeof e.getOrCreateInstance=="function"?e.getOrCreateInstance(t):new e(t)}function on(e){return e?typeof e=="string"?document.querySelector(e):e:null}function ct(e,t){return it.has(e)?it.get(e)():t()}async function an(){he||(he=ct("collapse",()=>import("./chunks/collapse-5AVOIS7J.js")));let e=await he;return at(e)}async function sn(){we||(we=ct("offcanvas",()=>import("./chunks/offcanvas-7MPV3VGN.js")));let e=await we;return at(e)}function cn(){document.querySelectorAll('[data-bs-toggle="collapse"][data-bs-target]').forEach(t=>{t.addEventListener("click",n=>{dn(t)&&n.preventDefault(),typeof n.stopImmediatePropagation=="function"&&n.stopImmediatePropagation(),n.stopPropagation(),ln(t,n)})})}async function ln(e,t){var n;try{let r=e.getAttribute("data-bs-target");if(!r)return;let a=document.querySelector(r);if(!a)return;let d=await an(),m=st(d,a);(n=m==null?void 0:m.toggle)==null||n.call(m,t)}catch(r){console.error("No se pudo inicializar el Collapse de Bootstrap",r)}}function dn(e){if(!e||e.tagName!=="A")return!1;let t=e.getAttribute("href");return!t||t==="#"}function lt(){ot||(ot=!0,typeof document!="undefined"&&(cn(),rt()))}async function dt(e){if(typeof document=="undefined")throw new Error("Offcanvas no disponible en este entorno");let t=on(e);if(!t)throw new Error("No se encontr\xF3 el elemento de Offcanvas");let n=await sn(),r=st(n,t);if(!r||typeof r.show!="function")throw new Error("Instancia de Offcanvas inv\xE1lida");return r.show(),r}function be(e,t={}){let n=e.startsWith("/")?e:"/"+e,r=Object.entries(t).map(([d,m])=>`${d}=${m}`).join(","),a=n.split("/").map(encodeURIComponent).join("/");return`/cdn-cgi/image/${r}${a}`}var ve={fit:"cover",quality:75,format:"auto"};var wt="__PRODUCT_DATA__",ce=null,L=Object.freeze({hidden:"is-hidden",flex:"is-flex",block:"is-block",contentVisible:"has-content-visibility",containIntrinsic:"has-contain-intrinsic"}),bt=Object.freeze([200,320,400]),un="(min-width: 1200px) 280px, (min-width: 992px) 240px, (min-width: 576px) 45vw, 80vw",Ce=Object.freeze([80,120,160]),F=(e="")=>e?`/${e.startsWith("/")?e.slice(1):e}`:"",vt=(e,t={})=>{let n=F(e);return n?be(n,{...ve,...t}):""},ke=(e,t={},n=bt)=>{let r=F(e);return r?n.map(a=>`${be(r,{...ve,width:a,...t})} ${a}w`).join(", "):""},fn=Object.freeze(["descriptor","d"]),se=e=>{if(!e)return"";let t=r=>{if(typeof r=="string"){let a=r.trim();return a||""}return typeof r=="number"&&Number.isFinite(r)?`${r}w`:""},n=r=>{if(typeof r=="string")return F(r);if(r&&typeof r=="object"){let a=r.src||r.path||r.url||"",d=F(a);if(!d)return"";let m=fn.find(p=>p in r),u=t(m?r[m]:r.width);return u?`${d} ${u}`:d}return""};if(Array.isArray(e))return e.map(n).filter(Boolean).join(", ");if(e&&typeof e=="object"){if(typeof e.srcset=="string"){let r=e.srcset.trim();if(r)return r}return Array.isArray(e.variants)?e.variants.map(n).filter(Boolean).join(", "):n(e)}return F(e)},ut=e=>{if(typeof e!="string")return!1;let t=e.trim();return t?/\.avif(?:[?#].*)?$/i.test(t):!1},Ct=(e,t=bt)=>{if(!e)return"";if(Array.isArray(e)){let n=se(e);if(n&&/\.avif/i.test(n))return n}if(e&&typeof e=="object"&&!Array.isArray(e)){let n=se(e);if(n&&/\.avif/i.test(n))return n;let r=e.src||e.path||e.url||"";if(ut(r))return se(r)}return ut(e)?se(e):ke(e,{format:"avif"},t)};function Pe(){if(typeof window!="undefined"){let e=window[wt];if(e&&Array.isArray(e.products))return e}return ce&&Array.isArray(ce.products)?ce:null}function Et(e,t={},{force:n=!1}={}){if(!Array.isArray(e))return null;let r={products:e,version:t.version||null,source:t.source||null,updatedAt:t.updatedAt||Date.now(),isPartial:!!t.isPartial,total:typeof t.total=="number"?t.total:null},a=Pe();if(a&&!n){let d=a.version||null,m=r.version||null;if(!m&&d||!m&&!d||m&&d===m)return a}return ce=r,typeof window!="undefined"&&(window[wt]={...r}),r}function Ie(e,t={}){return Et(e,t,{force:!1})}function pn(e,t={}){return Et(e,t,{force:!0})}var Le={path:"/service-worker.js",scope:"/",updateCheckInterval:300*1e3},mn=new Set(["localhost","127.0.0.1","::1","[::1]"]);function ft(e){var t,n;if(typeof window=="undefined")return null;try{let r=(n=(t=window.localStorage)!=null?t:globalThis.localStorage)!=null?n:null;return r?r.getItem(e):null}catch(r){return console.warn("Unable to access localStorage for key",e,r),null}}function gn(){var r,a,d,m;if(typeof window=="undefined")return!1;if(ft("ebano-sw-disabled")==="true")return console.info("Service worker registration skipped by kill-switch flag."),!1;let t=(a=(r=window.location)==null?void 0:r.hostname)!=null?a:"";if(mn.has(t)){let u=ft("ebano-sw-enable-local"),p=(m=(d=window.location)==null?void 0:d.search)!=null?m:"",b=typeof p=="string"&&/(?:^|[?&])sw=on(?:&|$)/i.test(p);return u==="true"||b?!0:(console.info("Service worker registration skipped on localhost. Set localStorage ebano-sw-enable-local=true to override."),!1)}return!0}var pt=!1;function St(){if(!("serviceWorker"in navigator)){console.warn("Service workers are not supported in this browser");return}if(!gn()||pt)return;pt=!0;let e=async()=>{if(document.readyState==="complete"){window.removeEventListener("load",e);try{await yn()}catch(t){console.error("Service Worker initialization failed:",t),En("Failed to initialize service worker. Some features may not work offline.")}}};window.addEventListener("load",e),e()}async function yn(){try{let e=await navigator.serviceWorker.register(Le.path,{scope:Le.scope});console.log("ServiceWorker registered successfully:",e.scope),hn(e),wn(e),bn(),vn()}catch(e){throw console.error("ServiceWorker registration failed:",e),e}}function hn(e){e.addEventListener("updatefound",()=>{let t=e.installing;t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&t.postMessage({type:"SKIP_WAITING"})})})}function wn(e){mt(e),setInterval(()=>{mt(e)},Le.updateCheckInterval)}async function mt(e){var t;try{await e.update();let n=await fetch("/data/product_data.json",{cache:"no-store",headers:{Accept:"application/json"}});if(n.ok){let a=(await n.json()).version,d=localStorage.getItem("productDataVersion");a!==d&&((t=e.active)==null||t.postMessage({type:"INVALIDATE_PRODUCT_CACHE"}),localStorage.setItem("productDataVersion",a),Cn(null,"New product data available"))}}catch(n){console.warn("Update check failed:",n)}}function bn(){let e=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{e||(e=!0,window.location.reload())})}function vn(){let e=document.getElementById("offline-indicator");if(!e)return;let t=()=>{let n=navigator.onLine;e.classList.toggle(L.hidden,n),e.classList.toggle(L.block,!n),n||Sn("You are currently offline. Some features may be limited.")};window.addEventListener("online",t),window.addEventListener("offline",t),navigator.onLine||t()}var Ee=null;function Te(){return Ee||(Ee=import("./chunks/notifications-533VS4FV.js")),Ee}function Cn(e,t="Una versi\xF3n est\xE1 disponible"){Te().then(n=>n.showUpdateNotification(e,t))}function En(e){Te().then(t=>t.showServiceWorkerError(e))}function Sn(e){Te().then(t=>t.showConnectivityNotification(e))}typeof navigator!="undefined"&&"serviceWorker"in navigator&&St();var _n=e=>typeof e=="object"&&e!==null||typeof e=="function",Se=()=>({map:new Map,weakMap:new WeakMap,hasValue:!1,value:void 0}),In=(e,t=100)=>{if(typeof e!="function")throw new TypeError("Expected a function to memoize");(!Number.isFinite(t)||t<0)&&(t=0);let n=Se(),r=[],a=u=>{let p=r.indexOf(u);p!==-1&&r.splice(p,1),t>0&&r.push(u)},d=()=>{if(t!==0)for(;r.length>t;){let u=r.shift();u&&(u.hasValue=!1,u.value=void 0)}},m=(u,p)=>{if(_n(p)){let g=u.weakMap.get(p);return g||(g=Se(),u.weakMap.set(p,g)),g}return u.map.has(p)||u.map.set(p,Se()),u.map.get(p)};return(...u)=>{if(t===0)return e(...u);let p=n;for(let g=0;g<u.length;g+=1)p=m(p,u[g]);if(p.hasValue)return a(p),p.value;let b=e(...u);return p.value=b,p.hasValue=!0,a(p),d(),b}},Ln=(e,t)=>{let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>e(...r),t)}},An=(e,t=500)=>typeof window!="undefined"&&typeof window.requestIdleCallback=="function"?{type:"idle",handle:window.requestIdleCallback(e,{timeout:t})}:{type:"timeout",handle:setTimeout(e,0)},kn=e=>{e&&(e.type==="idle"&&typeof window!="undefined"&&typeof window.cancelIdleCallback=="function"?window.cancelIdleCallback(e.handle):e.type==="timeout"&&clearTimeout(e.handle))},j=e=>{if(!e)return"";try{return String(e).normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9]/g,"").toLowerCase()}catch(t){return String(e).toLowerCase()}},_t="General",It="Producto",Pn=(e,t=0)=>{let n=e&&typeof e=="object",r=n&&typeof e.name=="string"?e.name.trim():"",a=n&&typeof e.category=="string"?e.category.trim():"",d=r.length>0?r:`${It}-${t+1}`,m=a.length>0?a:_t,u=`${d}-${m}`.toLowerCase(),p=0;for(let E=0;E<u.length;E+=1){let S=u.charCodeAt(E);p=(p<<5)-p+S,p&=p}let g=r.length===0||a.length===0?`-${t}`:"";return`pid-${Math.abs(p)}${g}`},_e=e=>{let t=document.createElement("div");return t.textContent=e,t.innerHTML},Tn="product-data",xn=()=>{try{return typeof localStorage=="undefined"?null:localStorage.getItem("productDataVersion")}catch(e){return console.warn("Unable to read stored product data version:",e),null}},gt=e=>{if(e)try{if(typeof localStorage=="undefined")return;localStorage.setItem("productDataVersion",e)}catch(t){console.warn("Unable to persist product data version:",t)}},Lt=()=>{if(typeof document=="undefined")return null;try{let e=document.getElementById(Tn);if(!e||!e.textContent)return null;let t=e.textContent.trim();if(!t)return null;let n=JSON.parse(t);return n?Array.isArray(n.initialProducts)?n:Array.isArray(n.products)?{...n,initialProducts:n.products}:null:null}catch(e){return B("warn","inline_product_parse_failure",{error:e.message}),null}},On=(e,t)=>{if(!e||typeof e!="object")return null;let n=typeof e.id=="string"&&e.id.trim().length>0?e.id.trim():Pn(e,t),r=typeof e.originalIndex=="number"?e.originalIndex:typeof e.order=="number"?e.order:t,a=typeof e.name=="string"&&e.name.trim().length>0?e.name:`${It} ${t+1}`,d=typeof e.description=="string"?e.description:"",m=typeof e.category=="string"&&e.category.trim().length>0?e.category:_t,u=typeof e.image_path=="string"?e.image_path:"",p=typeof e.image_avif_path=="string"?e.image_avif_path:"";return{...e,id:n,name:_e(a),description:_e(d),category:_e(m),categoryKey:e.categoryKey||j(m),image_path:u,image_avif_path:p,originalIndex:r}},Ae=(e=[])=>e.map((t,n)=>On(t,n)).filter(Boolean);function qn(){let e=Pe();if(e)return e;let t=Lt();if(!t||!Array.isArray(t.initialProducts))return null;let n=Ae(t.initialProducts);return Ie(n,{version:t.version||null,source:"inline",isPartial:!0,total:typeof t.totalProducts=="number"?t.totalProducts:n.length})}qn();var Z=class extends Error{constructor(t,{cause:n,correlationId:r}){super(t),this.name="ProductDataError",this.correlationId=r,n&&(this.cause=n)}},Dn=async(e,t,n,r,a)=>{let d=new URL(e,window.location.origin);if(d.origin!==window.location.origin||d.protocol!=="https:")throw new Error("Invalid request URL: only same-origin HTTPS requests are allowed");let m=d.toString(),u=0,p;for(;u<=n;)try{let b=Date.now(),g=await fetch(m,t),E=Date.now()-b;if(B("info","fetch_products_attempt",{correlationId:a,attempt:u+1,durationMs:E}),!g.ok)throw new Error(`HTTP error. Status: ${g.status}`);return g}catch(b){if(p=b,u++,u>n)break;B("warn","fetch_products_retry",{correlationId:a,attempt:u,error:b.message,runbook:"RUNBOOK.md#product-data"}),await new Promise(g=>setTimeout(g,r*u))}throw new Z(`Failed to fetch products: ${p.message}`,{cause:p,correlationId:a})},Mn=async()=>{let e=Ue(),t=Lt(),n=(t==null?void 0:t.initialProducts)||null,r=(t==null?void 0:t.version)||null,a=typeof(t==null?void 0:t.totalProducts)=="number"?t.totalProducts:null,d=Array.isArray(n)?Ae(n):null,m=Array.isArray(d),u=xn();m&&(r&&gt(r),Ie(d,{version:r||null,source:"inline",isPartial:!0,total:a!=null?a:d.length}),B("info","fetch_products_inline_bootstrap",{correlationId:e,count:d.length}));let p=u||r||null,b=p?`/data/product_data.json?v=${encodeURIComponent(p)}`:"/data/product_data.json";try{let E=await(await Dn(b,{cache:"no-store",headers:{Accept:"application/json"}},2,300,e)).json(),S=Ae(E.products||[]);return pn(S,{version:E.version||null,source:"network",isPartial:!1,total:S.length}),E.version&&gt(E.version),B("info","fetch_products_success",{correlationId:e,count:S.length,source:"network"}),S}catch(g){if(m)return Ie(d,{version:r||null,source:"inline-fallback",isPartial:!0,total:a!=null?a:d.length}),B("warn","fetch_products_network_fallback_inline",{correlationId:e,error:g.message,runbook:"RUNBOOK.md#product-data"}),d;throw B("error","fetch_products_failure",{correlationId:e,error:g.message,runbook:"RUNBOOK.md#product-data"}),x(`Error al cargar los productos. Por favor, verifique su conexi\xF3n a internet e int\xE9ntelo de nuevo. (Error: ${g.message})`),g instanceof Z?g:new Z(g.message,{cause:g,correlationId:e})}},y=(e,t={},n=[])=>{let r=document.createElement(e);return Object.entries(t).forEach(([a,d])=>{a==="text"?r.textContent=d:r.setAttribute(a,d)}),n.forEach(a=>{typeof a=="string"?r.appendChild(document.createTextNode(a)):r.appendChild(a)}),r},Bn=({imagePath:e,avifPath:t,alt:n,eager:r=!1})=>{let a=un,d=[],m=Ct(t);m&&d.push(y("source",{type:"image/avif",srcset:m,sizes:a}));let u=vt(e,{width:320})||F(e),p=ke(e),b={src:u||"",alt:n||"",class:"card-img-top product-thumb",loading:r?"eager":"lazy",fetchpriority:r?"high":"auto",decoding:"async",width:"400",height:"400",sizes:a};p&&(b.srcset=p);let g=y("img",b);return d.push(g),y("picture",{},d)},Nn=({imagePath:e,avifPath:t,alt:n})=>{let r="100px",a=[],d=Ct(t,Ce);d&&a.push(y("source",{type:"image/avif",srcset:d,sizes:r}));let m=vt(e,{width:Ce[1]})||F(e),u=ke(e,{},Ce),p={src:m||"",alt:n||"",class:"cart-item-thumb-img",loading:"lazy",decoding:"async",width:"100",height:"100",sizes:r};u&&(p.srcset=u);let b=y("img",p);return y("picture",{},[...a,b])},x=e=>{let t=y("div",{class:"error-message",role:"alert"},[y("p",{},[e]),y("button",{class:"retry-button"},["Intentar nuevamente"])]),n=document.getElementById("product-container");n?(n.innerHTML="",n.appendChild(t),t.querySelector(".retry-button").addEventListener("click",At)):console.error("Contenedor de productos no encontrado")},yt=[],ht;try{yt=JSON.parse((ht=globalThis.localStorage)==null?void 0:ht.getItem("cart"))||[]}catch(e){yt=[]}var $n=(e=typeof window!="undefined"?window.performance:void 0)=>{let t="unavailable",n="unavailable",r="unavailable";try{if(!e||typeof e.getEntriesByType!="function")return;let a=e.getEntriesByType("paint")||[],d=e.getEntriesByType("navigation")||[],m=a.find(p=>(p==null?void 0:p.name)==="first-contentful-paint")||a[0];m&&typeof m.startTime=="number"&&(t=m.startTime);let u=d[0];u&&typeof u.domContentLoadedEventEnd=="number"?n=u.domContentLoadedEventEnd:e.timing&&typeof e.timing.domContentLoadedEventEnd=="number"&&(n=e.timing.domContentLoadedEventEnd),u&&typeof u.loadEventEnd=="number"?r=u.loadEventEnd:e.timing&&typeof e.timing.loadEventEnd=="number"&&(r=e.timing.loadEventEnd)}catch(a){console.warn("Performance metrics unavailable:",a)}finally{console.log("First Contentful Paint:",t),console.log("DOM Content Loaded:",n),console.log("Load Time:",r)}};typeof window!="undefined"&&(window.__APP_READY__=!1,window.addEventListener("error",e=>{let t=e.target||e.srcElement,n=!!(t&&(t.tagName==="IMG"||t.tagName==="SCRIPT"||t.tagName==="LINK")),r=!!e.error;if(n||!r){console.warn("Ignored non-fatal error:",{tag:t&&t.tagName,src:t&&(t.src||t.href||t.currentSrc)});return}if(!window.__APP_READY__){console.error("Runtime error before app ready:",e.error);return}console.error("Unhandled JS error:",e.error),x("Ocurri\xF3 un error inesperado. Por favor, recarga la p\xE1gina.")}),window.addEventListener("securitypolicyviolation",e=>{console.warn("CSP violation (logged only):",{blockedURI:e.blockedURI,violatedDirective:e.violatedDirective,sourceFile:e.sourceFile})}));var At=async()=>{var je,Fe,ze;console.log("Initializing app...");let e=document.getElementById("product-container"),t=document.getElementById("sort-options"),n=document.getElementById("filter-keyword"),r=document.getElementById("cart-count"),a=document.getElementById("cart-items"),d=document.getElementById("cart-total"),u=Object.entries({"#product-container":e,"#sort-options":t,"#filter-keyword":n,"#cart-count":r,"#cart-items":a,"#cart-total":d}).filter(([,o])=>!o).map(([o])=>o);if(u.length){B("warn","init_app_missing_dom",{missingSelectors:u,location:typeof window!="undefined"?(je=window.location)==null?void 0:je.pathname:"unknown"});return}let p=()=>{let o=document.getElementById("filter-discount");if(o)return o;let s=document.querySelector('section[aria-label*="filtrado"], section[aria-label*="Opciones de filtrado"]'),l=s?s.querySelector(".row"):null;if(!l)return null;let c=y("div",{class:"col-12 mt-2"}),i=y("div",{class:"form-check form-switch"}),f=y("input",{class:"form-check-input",type:"checkbox",id:"filter-discount","aria-label":"Mostrar solo productos con descuento"}),w=y("label",{class:"form-check-label",for:"filter-discount"},["Solo productos con descuento"]);return i.appendChild(f),i.appendChild(w),c.appendChild(i),l.appendChild(c),f},b=12,g=12,E=[],S=[],P=0,z=b,R=null,X=null,ee=null,te=!1,A=JSON.parse(localStorage.getItem("cart"))||[],le=()=>{let o=document.getElementById("offline-indicator");if(o){let s=navigator.onLine;o.classList.toggle(L.hidden,s),o.classList.toggle(L.block,!s)}navigator.onLine||console.log("App is offline. Using cached data if available.")};function Pt(){let o=document.getElementById("current-year");o&&(o.textContent=new Date().getFullYear())}let ne="CLP",xe=!1,Tt=o=>{if(typeof o!="string")return ne;let s=o.trim().toUpperCase();return/^[A-Z]{3}$/.test(s)?s:ne},xt=o=>{let s=Tt(o);try{return new Intl.NumberFormat("es-CL",{style:"currency",currency:s,minimumFractionDigits:0})}catch(l){return xe||(console.warn("Falling back to CLP currency formatter",{error:l,currencyCode:o}),xe=!0),new Intl.NumberFormat("es-CL",{style:"currency",currency:ne,minimumFractionDigits:0})}},Ot=(o,s,l=ne)=>{let c=Number(o)||0,i=Number(s)||0,f=xt(l),w=f.format(c);if(i){let v=Math.max(c-i,0),I=f.format(v);return y("div",{class:"precio-container"},[y("span",{class:"precio-descuento","aria-label":"Precio con descuento"},[I]),y("span",{class:"precio-original","aria-label":"Precio original"},[y("span",{class:"tachado"},[w])])])}return y("div",{class:"precio-container"},[y("span",{class:"precio","aria-label":"Precio"},[w])])},qt=o=>{let s=y("div",{class:`quantity-control ${L.hidden}`,role:"group","aria-label":"Seleccionar cantidad","aria-live":"polite"}),l=y("button",{class:"quantity-btn",type:"button","data-action":"decrease","aria-label":"Decrease quantity"},["-"]),c=y("button",{class:"quantity-btn",type:"button","data-action":"increase","aria-label":"Increase quantity"},["+"]),i=y("input",{type:"number",class:"quantity-input",value:Math.max(W(o.id),1),min:"1",max:"50","aria-label":"Quantity","data-id":o.id});return s.appendChild(l),s.appendChild(i),s.appendChild(c),s};function Oe(o,s){var O;if(!o)return;let l=o.querySelector(".add-to-cart-btn"),c=o.querySelector(".quantity-control"),i=c==null?void 0:c.querySelector(".quantity-input"),f=(c==null?void 0:c.querySelector('.quantity-btn[data-action="decrease"]'))||(c==null?void 0:c.querySelector(".quantity-btn")),w=(c==null?void 0:c.querySelector('.quantity-btn[data-action="increase"]'))||((O=c==null?void 0:c.querySelectorAll(".quantity-btn"))==null?void 0:O[1]),v=(h,C,_)=>{h&&h.dataset.listenerAttached!=="true"&&(h.addEventListener(C,_),h.dataset.listenerAttached="true")};v(l,"click",()=>{Ne(s,1),G(l,c,!0)}),v(f,"click",()=>K(s,-1)),v(w,"click",()=>K(s,1)),v(i,"change",h=>{let C=parseInt(h.target.value,10);if(!Number.isFinite(C)){h.target.value=Math.max(W(s.id),1);return}let _=W(s.id);K(s,C-_)});let I=W(s.id);i&&(i.value=I>0?I:1),G(l,c,I>0)}let W=o=>{let s=A.find(l=>l.id===o);return s?s.quantity:0},Dt=(o,{reset:s=!1}={})=>{if(!e)return 0;s&&(e.innerHTML="");let l=document.createDocumentFragment();return o.forEach(c=>{let{id:i,name:f,description:w,image_path:v,image_avif_path:I,price:O,discount:h,stock:C}=c,_=["producto","col-12","col-sm-6","col-md-4","col-lg-3","mb-4",C?"":"agotado",L.contentVisible,L.containIntrinsic].filter(Boolean).join(" "),$=`product-title-${i}`,U=y("article",{class:_,"data-product-id":i,"aria-labelledby":$}),q=y("div",{class:"card h-100"});if(h&&Number(h)>0){let Q=Math.round(Number(h)/Number(O)*100),ie=y("span",{class:"discount-badge badge bg-danger","aria-label":"Producto en oferta"},[`-${isFinite(Q)?Q:0}%`]);q.appendChild(ie)}let oe=Bn({imagePath:v,avifPath:I,alt:f,eager:!1});q.appendChild(oe);let N=y("div",{class:"card-body d-flex flex-column"});N.appendChild(y("h3",{class:"card-title mb-2",id:$},[f])),N.appendChild(y("p",{class:"card-text mb-3"},[w]));let D=Ot(O,h);D.classList.add("mb-3"),N.appendChild(D);let k=y("div",{class:"action-area mt-auto","data-pid":i,role:"group","aria-label":`Acciones de compra para ${f}`}),T=y("button",{class:"btn btn-primary add-to-cart-btn mt-2",type:"button","data-id":i,"aria-label":`Add ${f} to cart`},["Agregar al carrito"]),Re=qt(c);k.appendChild(T),k.appendChild(Re),N.appendChild(k),Oe(k,c),q.appendChild(N),U.appendChild(q),l.appendChild(U)}),e.appendChild(l),Nt(),o.length},Mt=o=>{if(!e)return 0;let s=e.querySelectorAll("[data-product-id]");if(!s.length)return 0;let l=new Map(o.map(i=>[i.id,i])),c=0;return s.forEach(i=>{let f=i.getAttribute("data-product-id");if(!f||!l.has(f))return;let w=l.get(f);i.classList.add(L.contentVisible,L.containIntrinsic);let v=i.querySelector(".action-area");Oe(v,w),c+=1}),c},qe=()=>{e&&(e.innerHTML=""),P=0},de=()=>{var c,i,f;let o=(t==null?void 0:t.value)||"original",s=((i=(c=n==null?void 0:n.value)==null?void 0:c.trim)==null?void 0:i.call(c))||"",l=((f=document.getElementById("filter-discount"))==null?void 0:f.checked)||!1;S=Ut(E,s,o,l)},De=o=>{if(!Array.isArray(S)||S.length===0)return M(),!1;let s=P;if(s>=S.length)return M(),!1;let l=S.slice(s,s+o);return l.length?(Dt(l),P+=l.length,M(),!0):(M(),!1)},ue=()=>De(z||b),Me=()=>De(g),M=()=>{let o=P<S.length;R&&(R.classList.toggle("d-none",!o),R.disabled=!o),ee&&X&&(ee.disconnect(),o&&ee.observe(X))},Bt=()=>{R=document.getElementById("catalog-load-more"),X=document.getElementById("catalog-sentinel"),R&&R.addEventListener("click",()=>{Me()}),X&&typeof window!="undefined"&&"IntersectionObserver"in window&&(ee=new IntersectionObserver(o=>{o.forEach(s=>{s.isIntersecting&&Me()})},{rootMargin:"200px"})),M()},Nt=()=>{if(typeof window!="undefined"&&"IntersectionObserver"in window){let o=new IntersectionObserver((s,l)=>{s.forEach(c=>{if(c.isIntersecting){let i=c.target;i.src=i.dataset.src,i.dataset.srcset&&(i.srcset=i.dataset.srcset),i.dataset.sizes&&(i.sizes=i.dataset.sizes),i.classList.remove("lazyload"),l.unobserve(i)}})},{rootMargin:"100px"});document.querySelectorAll("img.lazyload").forEach(s=>o.observe(s))}else document.querySelectorAll("img.lazyload").forEach(o=>{o.dataset.src&&(o.src=o.dataset.src),o.dataset.srcset&&(o.srcset=o.dataset.srcset),o.dataset.sizes&&(o.sizes=o.dataset.sizes),o.classList.remove("lazyload")})};function $t(o,s){if(!o||!s||o.length<3)return!1;let l=f=>f.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim(),c=l(o),i=l(s);return i.includes(c)?!0:c.length>=4?jt(c,i):!1}function jt(o,s){return s.split(/\s+/).some(c=>{if(Math.abs(c.length-o.length)>1)return!1;let i=0,f=Math.max(c.length,o.length);if(Math.min(c.length,o.length)<4)return!1;if(c.length===o.length){for(let v=0;v<c.length;v++)if(c[v]!==o[v]&&i++,i>1)return!1;return i===1}else return Ft(o,c)})}function Ft(o,s){let l=o.length>s.length?o:s,c=o.length>s.length?s:o;if(l.length-c.length!==1)return!1;let i=0,f=0,w=0;for(;f<c.length&&w<l.length;)if(c[f]===l[w])f++,w++;else{if(i++,i>1)return!1;w++}return!0}let zt=(o,s,l,c=!1)=>{let i=s.trim();return o.filter(f=>!f.stock||c&&!(f.discount&&Number(f.discount)>0)?!1:!i||f.name.toLowerCase().includes(i.toLowerCase())||f.description.toLowerCase().includes(i.toLowerCase())?!0:i.length>=4?$t(i,f.name):!1).sort((f,w)=>Rt(f,w,l))},Rt=(o,s,l)=>{if(!l||l==="original")return o.originalIndex-s.originalIndex;let[c,i]=l.split("-"),f=c==="price"?o.price-(o.discount||0):o.name.toLowerCase(),w=c==="price"?s.price-(s.discount||0):s.name.toLowerCase();return i==="asc"?f<w?-1:f>w?1:0:w<f?-1:w>f?1:0},Ut=In(zt),Be=()=>{try{if(de(),qe(),!S.length){M();return}ue()}catch(o){console.error("Error al actualizar visualizaci\xF3n de productos:",o),x("Error al actualizar la visualizaci\xF3n de productos. Por favor, intenta m\xE1s tarde.")}},fe=null,pe=Ln(()=>{kn(fe),fe=An(()=>{Be(),fe=null},400)},150),V=()=>{let o=document.getElementById("cart-count"),s=A.reduce((l,c)=>l+c.quantity,0);o.textContent=s,o.setAttribute("aria-label",`${s} items in cart`)},Ne=(o,s)=>{try{let l=A.find(i=>i.id===o.id);l?l.quantity=Math.min(l.quantity+s,50):A.push({id:o.id,name:o.name,description:o.description,price:o.price,discount:o.discount,image_path:o.image_path,image_avif_path:o.image_avif_path,quantity:Math.min(s,50),category:o.category,stock:o.stock}),re(),V(),Y();let c=document.querySelector(`[data-id="${o.id}"].quantity-input`);c&&(c.value=Math.max(W(o.id),1))}catch(l){console.error("Error al agregar al carrito:",l),x("Error al agregar el art\xEDculo al carrito. Por favor, intenta nuevamente.")}},$e=o=>{try{A=A.filter(l=>l.id!==o),re(),V(),Y();let s=document.querySelector(`.action-area[data-pid="${o}"]`);if(s){let l=s.querySelector(".add-to-cart-btn"),c=s.querySelector(".quantity-control");G(l,c,!1)}}catch(s){console.error("Error al eliminar del carrito:",s),x("Error al eliminar el art\xEDculo del carrito. Por favor, intenta nuevamente.")}},K=(o,s)=>{try{let l=A.find(v=>v.id===o.id),c=l?l.quantity+s:1,i=document.querySelector(`.action-area[data-pid="${o.id}"]`),f=i==null?void 0:i.querySelector(".add-to-cart-btn"),w=i==null?void 0:i.querySelector(".quantity-control");if(c<=0)$e(o.id),G(f,w,!1);else if(c<=50){l?l.quantity=c:(Ne(o,1),G(f,w,!0)),re(),V(),Y();let v=document.querySelector(`[data-id="${o.id}"].quantity-input`);v&&(v.value=c,v.classList.add("quantity-changed"),setTimeout(()=>v.classList.remove("quantity-changed"),300))}}catch(l){console.error("Error al actualizar cantidad:",l),x("Error al actualizar la cantidad. Por favor, intenta nuevamente.")}},Ht=()=>{try{A=[],re(),V(),Y(),Be()}catch(o){console.error("Error al vaciar el carrito:",o),x("Error al vaciar el carrito. Por favor, int\xE9ntelo de nuevo.")}},G=(o,s,l)=>{if(!o||!s)return;let c=!l;o.classList.toggle(L.hidden,!c),o.classList.toggle(L.flex,c),s.classList.toggle(L.hidden,!l),s.classList.toggle(L.flex,l)},re=()=>{try{localStorage.setItem("cart",JSON.stringify(A))}catch(o){console.error("Error al guardar el carrito:",o),x("Error al guardar el carrito. Tus cambios podr\xEDan no persistir.")}},Y=()=>{let o=document.getElementById("cart-items"),s=document.getElementById("cart-total");o.innerHTML="";let l=0;A.forEach(i=>{let f=i.price-(i.discount||0),w=y("div",{class:"cart-item mb-3 d-flex align-items-start","aria-label":`Cart item: ${i.name}`}),v=y("div",{class:"cart-item-content flex-grow-1"});v.appendChild(y("div",{class:"fw-bold mb-1"},[i.name]));let I=y("div",{class:"mb-2"}),O=y("button",{class:"btn btn-sm btn-secondary decrease-quantity","data-id":i.id,"aria-label":`Disminuir cantidad de ${i.name}`},["-"]),h=y("button",{class:"btn btn-sm btn-secondary increase-quantity","data-id":i.id,"aria-label":`Aumentar cantidad de ${i.name}`},["+"]),C=y("span",{class:"mx-2 item-quantity","aria-label":`Cantidad de ${i.name}`},[i.quantity.toString()]);I.appendChild(O),I.appendChild(C),I.appendChild(h),v.appendChild(I),v.appendChild(y("div",{class:"text-muted small"},[`Precio: $${f.toLocaleString("es-CL")}`])),v.appendChild(y("div",{class:"fw-bold"},[`Subtotal: $${(f*i.quantity).toLocaleString("es-CL")}`]));let _=y("button",{class:"btn btn-sm btn-danger remove-item mt-2","data-id":i.id,"aria-label":`Eliminar ${i.name} del carrito`},["Eliminar"]);v.appendChild(_);let $=window.location.pathname.includes("/pages/"),U;$?U=`../${i.image_path.replace(/^\//,"")}`:U=i.image_path;let q=y("div",{class:"cart-item-thumb ms-3 flex-shrink-0"}),oe=i.thumbnail_path||U,N=Nn({imagePath:i.thumbnail_path||i.image_path,avifPath:i.image_avif_path,alt:i.name}),D=N.querySelector("img");if(D)if(!D.getAttribute("src")&&oe&&D.setAttribute("src",oe),Array.isArray(i.thumbnail_variants)){let k=i.thumbnail_variants.filter(T=>T&&T.url&&T.width).map(T=>`${T.url} ${T.width}w`);k.length&&(D.setAttribute("srcset",k.join(", ")),D.setAttribute("sizes","100px"))}else D.getAttribute("sizes")||D.setAttribute("sizes","100px");if(q.appendChild(N),w.appendChild(v),w.appendChild(q),o.appendChild(w),window.__DEBUG_CART__)try{let k=window.getComputedStyle(w),T=window.getComputedStyle(q),Re=window.getComputedStyle(v),Q=q.getBoundingClientRect(),ie=v.getBoundingClientRect();console.debug("[cart] item",{name:i.name,order:{firstIsContent:w.firstChild===v,lastIsThumb:w.lastChild===q},container:{display:k.display,flexDirection:k.flexDirection,flexWrap:k.flexWrap},thumb:{width:T.width,height:T.height,rect:{w:Q.width,h:Q.height}},content:{rect:{w:ie.width,h:ie.height}}})}catch(k){}l+=f*i.quantity}),s.textContent=`Total: $${l.toLocaleString("es-CL")}`,s.setAttribute("aria-label",`Total: $${l.toLocaleString("es-CL")}`);let c=document.getElementById("payment-credit-container");if(c)if(l>=3e4)c.classList.remove("d-none");else{c.classList.add("d-none");let i=c.querySelector("input");i&&(i.checked=!1)}},Wt=()=>{let o=document.querySelector('input[name="paymentMethod"]:checked');if(!o){alert("Por favor seleccione un m\xE9todo de pago");return}let s=`Mi pedido:

`;A.forEach(i=>{let f=i.price-(i.discount||0);s+=`${i.name}
`,s+=`Cantidad: ${i.quantity}
`,s+=`Precio unitario: $${f.toLocaleString("es-CL")}
`,s+=`Subtotal: $${(f*i.quantity).toLocaleString("es-CL")}

`});let l=A.reduce((i,f)=>i+(f.price-(f.discount||0))*f.quantity,0);s+=`Total: $${l.toLocaleString("es-CL")}
`,s+=`M\xE9todo de pago: ${o.value}`;let c=encodeURIComponent(s);window.open(`https://wa.me/56951118901?text=${c}`,"_blank")};try{Pt();let o=Pe();(Fe=o==null?void 0:o.products)!=null&&Fe.length&&(E=o.products.map((h,C)=>({...h,originalIndex:typeof h.originalIndex=="number"?h.originalIndex:C,categoryKey:h.categoryKey||j(h.category)})));let s=document.querySelector("main"),l=((ze=s==null?void 0:s.dataset)==null?void 0:ze.category)||"";if(l){let h=j(l);E=E.filter(C=>(C.categoryKey||j(C.category))===h).map((C,_)=>({...C,originalIndex:typeof C.originalIndex=="number"?C.originalIndex:_}))}let c=Mt(E);c>0?(P=c,z=c):P=0,Bt(),de(),M(),P===0&&S.length&&ue();let i=Mn();t.addEventListener("change",()=>{te=!0,pe()}),n.addEventListener("input",()=>{te=!0,pe()});let f=p();f&&f.addEventListener("change",()=>{te=!0,pe()});let w=await i;if(!Array.isArray(w)||w.length===0){if(!E.length){x("No hay productos disponibles. Por favor, intenta m\xE1s tarde.");return}}else if(E=w.map((h,C)=>({...h,originalIndex:typeof h.originalIndex=="number"?h.originalIndex:C,categoryKey:h.categoryKey||j(h.category)})),l){let h=j(l);E=E.filter(C=>(C.categoryKey||j(C.category))===h).map((C,_)=>({...C,originalIndex:typeof C.originalIndex=="number"?C.originalIndex:_}))}de(),te||P===0?(qe(),S.length?ue():M()):M(),typeof window!="undefined"&&(window.__APP_READY__=!0),window.addEventListener("online",le),window.addEventListener("offline",le),le();let v=document.getElementById("cart-icon"),I=document.getElementById("empty-cart"),O=document.getElementById("submit-cart");v&&v.addEventListener("click",async()=>{Y();let h=document.getElementById("cartOffcanvas");try{await dt("#cartOffcanvas"),h&&(h.dataset.bsFallback="0")}catch(C){console.error("Bootstrap Offcanvas no est\xE1 disponible",C),h&&(h.dataset.bsFallback="1",h.classList.add("show"),h.removeAttribute("aria-hidden"))}}),I&&I.addEventListener("click",Ht),O&&O.addEventListener("click",Wt),a&&a.addEventListener("click",h=>{var $;let C=h.target,_=($=C.closest("[data-id]"))==null?void 0:$.dataset.id;_&&(C.classList.contains("decrease-quantity")?K({id:_},-1):C.classList.contains("increase-quantity")?K({id:_},1):C.classList.contains("remove-item")&&$e(_))}),V(),"performance"in window&&window.addEventListener("load",()=>{$n()})}catch(o){console.error("Error al inicializar productos:",o),x("Error al cargar productos. Por favor, int\xE9ntelo m\xE1s tarde.")}};typeof document!="undefined"&&document.addEventListener("DOMContentLoaded",function(){St(),At().catch(e=>{console.error("Error al inicializar la aplicaci\xF3n:",e),x("Error al inicializar la aplicaci\xF3n. Por favor, actualice la p\xE1gina.")})});function kt(){let e=document.documentElement;try{document.querySelectorAll('link[rel="stylesheet"][media="print"][data-defer]').forEach(t=>{t.media="all",t.removeAttribute("data-defer")})}catch(t){}e.dataset.enhancementsInit!=="1"&&(e.dataset.enhancementsInit="1",He(),Xe(),We(),Ve(),Ke(),Je(),Qe(),Ze(),lt())}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",kt):kt();try{typeof window!="undefined"&&window.__ANALYTICS_ENABLE__===!0&&import("./chunks/analytics-O2RU3SL6.js").then(e=>{e.initAnalytics({enabled:!0,consentRequired:!0,sampleRate:1}),window.__analyticsTrack=(t,n)=>{try{return e.track(t,n)}catch(r){return!1}},e.track("page_view",{path:location.pathname})}).catch(()=>{})}catch(e){}export{kt as __initEnhancementsOnceForTest};
