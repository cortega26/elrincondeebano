<!DOCTYPE html><html lang="es"><head>
  <!-- Essential Meta Tags -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, user-scalable=yes">
  <meta name="description" content="El Rincón de Ébano">

  <link rel="canonical" href="https://elrincondeebano.com/">
  <link rel="manifest" href="/app.webmanifest">

  <!-- Security -->
  <script src="dist/js/csp.js?v=2" async></script>

  <!-- Title and Favicon -->
  <title>El Rincón de Ébano</title>
  <link rel="icon" href="assets/images/web/favicon.ico" type="image/x-icon">

  <!-- Preconnect to External Domains -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&amp;family=Playfair+Display:wght@400;700&amp;display=swap" as="style">

  <!-- Performance Resource Hints -->
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="dns-prefetch" href="//fonts.gstatic.com">
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">

  <% const lcpImage = Array.isArray(products) && products.length > 0 ? products[0].image : null; %>
  <!-- Preload critical assets -->
  <link rel="preload" href="/dist/css/critical.min.css" as="style" fetchpriority="high">
  <link rel="preload" href="/cdn-cgi/image/fit=cover,quality=82,format=auto,width=64/assets/images/web/logo.webp" as="image" type="image/webp" fetchpriority="high">
  <% if (lcpImage) { %>
  <link rel="preload" href="<%= lcpImage.src %>" as="image" imagesrcset="<%= lcpImage.srcset %>" imagesizes="(min-width: 1200px) 25vw, (min-width: 992px) 33vw, (min-width: 576px) 50vw, 100vw" fetchpriority="high">
  <% } %>
  <!-- Critical CSS -->
  <link rel="stylesheet" href="dist/css/critical.min.css">

  <!-- Preload Critical Assets -->
  <link rel="preload" href="/cdn-cgi/image/fit=cover,quality=82,format=auto,width=64/assets/images/web/logo.webp" as="image" type="image/webp" fetchpriority="high">
  <link rel="preload" href="dist/js/script.min.js" as="script">

  <!-- Load main CSS synchronously to avoid FOUC/unstyled nav -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&amp;family=Playfair+Display:wght@400;700&amp;display=swap">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
  <link rel="stylesheet" href="dist/css/style.min.css?v=100">

  <!-- Fallback for No JavaScript -->
  <noscript>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&amp;family=Playfair+Display:wght@400;700&amp;display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    <link rel="stylesheet" href="dist/css/style.min.css?v=100">
  </noscript>

  <!-- Open Graph Tags -->
  <meta property="og:title" content="El Rincón de Ébano">
  <meta property="og:description" content="Un minimarket en la puerta de tu departamento">
  <meta property="og:image" content="https://elrincondeebano.com/assets/images/web/logo.webp">
  <meta property="og:url" content="https://elrincondeebano.com/">
  <meta property="og:type" content="website">
</head>

<body>

  <%- include('partials/navbar') %>

  <main data-category="" role="main">
    <div class="container my-4">
      <section class="hero-section text-center mb-5" aria-labelledby="main-heading">
        <h1 id="main-heading">Productos frescos directo a tu puerta</h1>
        <p class="lead text-muted mb-4">Compra en línea y recibe en minutos</p>
      </section>
      <section aria-label="Opciones de filtrado y ordenación">
        <div class="row mb-3">
          <div class="col-md-6">
            <select id="sort-options" class="form-select" aria-label="Ordenar productos">
              <option value="original" selected>Orden por defecto</option>
              <option value="name-asc">Nombre (A-Z)</option>
              <option value="name-desc">Nombre (Z-A)</option>
              <option value="price-asc">Precio (menor a mayor)</option>
              <option value="price-desc">Precio (mayor a menor)</option>
            </select>
          </div>
          <div class="col-md-6">
            <input type="text" id="filter-keyword" class="form-control" placeholder="Filtrar por nombre" aria-label="Filtrar productos por nombre">
          </div>
        </div>
      </section>
      <section aria-labelledby="products-heading">
        <h2 id="products-heading" class="visually-hidden">Productos disponibles</h2>
        <div class="row" id="product-container" aria-live="polite" data-total-products="<%= totalProducts %>">
<% products.forEach((product, index) => { %>
          <div class="producto col-12 col-sm-6 col-md-4 col-lg-3 mb-4 <%= product.stock ? '' : 'agotado' %> has-content-visibility has-contain-intrinsic" data-product-id="<%= product.id %>" aria-label="Product: <%= product.name %>">
            <div class="card">
<% if (product.isDiscounted) { %>
              <span class="discount-badge badge bg-danger" aria-label="Producto en oferta">-<%= product.discountPercent %>%</span>
<% } %>
              <img src="<%= product.image.src %>" srcset="<%= product.image.srcset %>" sizes="(min-width: 1200px) 25vw, (min-width: 992px) 33vw, (min-width: 576px) 50vw, 100vw" alt="<%= product.name %>" class="card-img-top product-thumb" loading="<%= index === 0 ? 'eager' : 'lazy' %>" fetchpriority="<%= index === 0 ? 'high' : 'auto' %>" decoding="async" width="400" height="400">
              <div class="card-body">
                <h3 class="card-title"><%= product.name %></h3>
                <p class="card-text"><%= product.description %></p>
                <div class="precio-container">
<% if (product.isDiscounted) { %>
                  <span class="precio-anterior" aria-label="Precio anterior">$<%= product.price.toLocaleString('es-CL') %></span>
                  <span class="precio" aria-label="Precio">$<%= product.discountedPrice.toLocaleString('es-CL') %></span>
<% } else { %>
                  <span class="precio" aria-label="Precio">$<%= product.price.toLocaleString('es-CL') %></span>
<% } %>
                </div>
                <div class="action-area" data-pid="<%= product.id %>">
                  <button class="btn btn-primary add-to-cart-btn mt-2" data-id="<%= product.id %>" aria-label="Agregar <%= product.name %> al carrito">Agregar al carrito</button>
                  <div class="quantity-control is-hidden">
                    <button class="quantity-btn" data-action="decrease" aria-label="Disminuir cantidad">-</button>
                    <input type="number" class="quantity-input" value="1" min="1" max="50" aria-label="Cantidad" data-id="<%= product.id %>">
                    <button class="quantity-btn" data-action="increase" aria-label="Aumentar cantidad">+</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
<% }); %>
        </div>
        <div id="catalog-controls" class="text-center my-4">
          <button type="button" id="catalog-load-more" class="btn btn-outline-primary d-none">Cargar más productos</button>
        </div>
        <div id="catalog-sentinel" aria-hidden="true"></div>
        <noscript>
          <div class="alert alert-info mt-4" role="status">Explora nuestras categorías mientras JavaScript está deshabilitado:</div>
          <ul class="list-unstyled row g-2 mt-3">
            <li class="col-12 col-sm-6 col-md-4"><a href="/pages/aguas.html">Aguas</a></li>
            <li class="col-12 col-sm-6 col-md-4"><a href="/pages/bebidas.html">Bebidas</a></li>
            <li class="col-12 col-sm-6 col-md-4"><a href="/pages/despensa.html">Despensa</a></li>
            <li class="col-12 col-sm-6 col-md-4"><a href="/pages/snacksdulces.html">Snacks dulces</a></li>
            <li class="col-12 col-sm-6 col-md-4"><a href="/pages/snackssalados.html">Snacks salados</a></li>
            <li class="col-12 col-sm-6 col-md-4"><a href="/pages/vinos.html">Vinos</a></li>
          </ul>
        </noscript>
      </section>
    </div>
    <div id="offline-indicator" aria-live="assertive" class="alert alert-warning is-hidden" role="alert">Actualmente estás sin conexión</div>
  </main>

  <%- include('partials/footer') %>

  <script type="application/json" id="product-data"><%- inlinePayload %></script>

  <script type="module" src="dist/js/script.min.js"></script>
  <!-- Service Worker registration handled in dist/js/script.min.js -->
</body></html>

