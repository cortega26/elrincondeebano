(()=>{var S=(t,r)=>()=>(t&&(r=t(t=0)),r);var Tt=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports);function tt(){try{let t=document.createElement("style");window&&window.__CSP_NONCE__&&t.setAttribute("nonce",window.__CSP_NONCE__),t.textContent=`
      /* Miniatura del carrito (mantener consistente con base/enhanced CSS) */
      .cart-item-thumb { width: 100px; height: 100px; flex-shrink: 0; }
      .cart-item-thumb img, .cart-item-thumb-img { width: 100%; height: 100%; object-fit: cover; border-radius: 0.25rem; }

      /* Contornos de enfoque claros para accesibilidad */
      .navbar .nav-link:focus,
      .navbar .dropdown-item:focus {
        outline: 2px solid var(--primary-color);
        outline-offset: 2px;
      }

      /* Espaciado entre botones en el offcanvas del carrito */
      #cartOffcanvas .offcanvas-body > .btn + .btn { margin-top: 0.5rem !important; }
    `,document.head.appendChild(t)}catch(t){console.warn("[modules/enhancements] injectEnhancementStyles error:",t)}}var et=S(()=>{});function nt(){try{document.addEventListener("keydown",r=>{r.key==="Tab"&&document.body.classList.add("keyboard-navigation")}),document.addEventListener("mousedown",()=>{document.body.classList.remove("keyboard-navigation")});let t=document.createElement("style");window&&window.__CSP_NONCE__&&t.setAttribute("nonce",window.__CSP_NONCE__),t.textContent=".keyboard-navigation *:focus { outline: 2px solid var(--primary-color); outline-offset: 2px; }",document.head.appendChild(t)}catch(t){console.warn("[modules/a11y] setupNavigationAccessibility error:",t)}}var ot=S(()=>{});function at(){try{"loading"in HTMLImageElement.prototype&&document.querySelectorAll("img:not([loading])").forEach(t=>{t.loading="lazy"})}catch(t){console.warn("[modules/perf] setupPerformanceOptimizations error:",t)}}var rt=S(()=>{});async function Mt(){try{let t=localStorage.getItem("productDataVersion"),r=t?`/_products/product_data.json?v=${encodeURIComponent(t)}`:"/_products/product_data.json",s=await fetch(r,{cache:"no-store",headers:{Accept:"application/json"}});if(!s.ok)return null;let m=await s.json(),d=Array.isArray(m?.products)?m.products:Array.isArray(m)?m:[],f={};return d.forEach(g=>{let y=g.id||String(g.name)+"-"+String(g.category);f[y]=g}),f}catch(t){return console.error("[modules/seo] Error loading product data:",t),null}}async function it(){try{if(document.querySelector('script[type="application/ld+json"]'))return;let t=await Mt();if(!t)return;let s=Object.values(t).slice(0,20).map(f=>({"@type":"Product",name:f.name,image:f.image_path,description:f.description,brand:f.brand||"Gen\xE9rico",offers:{"@type":"Offer",price:f.price,priceCurrency:"CLP",availability:f.stock?"https://schema.org/InStock":"https://schema.org/OutOfStock"}})),m={"@context":"https://schema.org","@graph":[{"@type":"Store",name:"El Rinc\xF3n de \xC9bano",image:"https://elrincondeebano.com/assets/images/web/logo.webp",description:"Un minimarket en la puerta de tu departamento",address:{"@type":"PostalAddress",addressCountry:"CL"},telephone:"+56951118901",url:"http://www.elrincondeebano.com/",contactPoint:{"@type":"ContactPoint",telephone:"+56-951118901",contactType:"customer service"}},...s]},d=document.createElement("script");d.type="application/ld+json",window&&window.__CSP_NONCE__&&d.setAttribute("nonce",window.__CSP_NONCE__),d.textContent=JSON.stringify(m),document.head.appendChild(d)}catch(t){console.error("[modules/seo] Error generating structured data:",t)}}function ct(){try{if(!document.querySelector('link[rel="canonical"]')){let t=document.createElement("link");t.rel="canonical",t.href=location.origin+location.pathname,document.head.appendChild(t)}if(!document.querySelector('meta[name="description"]')){let t=document.createElement("meta");t.name="description",t.content="El Rinc\xF3n de \xC9bano - Minimarket con delivery instant\xE1neo.",document.head.appendChild(t)}}catch(t){console.warn("[modules/seo] injectSeoMetadata error:",t)}}var st=S(()=>{});function lt(){try{if(!document.querySelector('link[rel="manifest"]')){let t=document.createElement("link");t.rel="manifest",t.href="/app.webmanifest",document.head.appendChild(t)}}catch(t){console.warn("[modules/pwa] injectPwaManifest error:",t)}}var dt=S(()=>{});function ut(){try{window?.console?.debug&&console.debug("[modules/checkout] setupCheckoutProgress: no-op")}catch{}}var mt=S(()=>{});function z(t,r={}){let s=t.startsWith("/")?t:"/"+t;return`/cdn-cgi/image/${Object.entries(r).map(([d,f])=>`${d}=${f}`).join(",")}${s}`}var B,pt=S(()=>{B={fit:"cover",quality:82,format:"auto"}});function gt(){if(!("serviceWorker"in navigator)){console.warn("Service workers are not supported in this browser");return}window.addEventListener("load",async()=>{try{Nt()}catch(t){console.error("Service Worker initialization failed:",t),Ft("Failed to initialize service worker. Some features may not work offline.")}})}async function Nt(){try{let t=await navigator.serviceWorker.register(K.path,{scope:K.scope});console.log("ServiceWorker registered successfully:",t.scope),Dt(t),zt(t),Bt(),jt()}catch(t){throw console.error("ServiceWorker registration failed:",t),t}}function Dt(t){t.addEventListener("updatefound",()=>{let r=t.installing;r.addEventListener("statechange",()=>{r.state==="installed"&&navigator.serviceWorker.controller&&r.postMessage({type:"SKIP_WAITING"})})})}function zt(t){ft(t),setInterval(()=>{ft(t)},K.updateCheckInterval)}async function ft(t){try{await t.update();let r=await fetch("/_products/product_data.json",{cache:"no-store",headers:{Accept:"application/json"}});if(r.ok){let m=(await r.json()).version,d=localStorage.getItem("productDataVersion");m!==d&&(t.active?.postMessage({type:"INVALIDATE_PRODUCT_CACHE"}),localStorage.setItem("productDataVersion",m),Rt(null,"New product data available"))}}catch(r){console.warn("Update check failed:",r)}}function Bt(){let t=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{t||(t=!0,window.location.reload())})}function jt(){let t=document.getElementById("offline-indicator");if(!t)return;let r=()=>{let s=navigator.onLine;t.classList.toggle("is-hidden",s),t.style.display=s?"none":"block",s||Ht("You are currently offline. Some features may be limited.")};window.addEventListener("online",r),window.addEventListener("offline",r),hidden||r()}function Rt(t,r="Una versi\xF3n est\xE1 disponible"){let s=G(r,"Actualizar ahora","Despu\xE9s",()=>{t?t.postMessage({type:"SKIP_WAITING"}):window.location.reload()});J(s)}function Ft(t){let r=G(t,"Reload","Dismiss",()=>window.location.reload());J(r)}function Ht(t){let r=G(t,"Retry","Dismiss",()=>window.location.reload());J(r)}function G(t,r,s,m){let d=document.createElement("div");return d.className="notification-toast",d.setAttribute("role","alert"),d.setAttribute("aria-live","polite"),d.innerHTML=`
        <div class="notification-content">
            <p>${t}</p>
            <div class="notification-actions">
                <button class="primary-action">${r}</button>
                <button class="secondary-action">${s}</button>
            </div>
        </div>
    `,d.querySelector(".primary-action").addEventListener("click",()=>{m(),d.remove()}),d.querySelector(".secondary-action").addEventListener("click",()=>{d.remove()}),d}function J(t){let r=document.querySelector(".notification-toast");r&&r.remove(),document.body.appendChild(t),setTimeout(()=>{document.body.contains(t)&&t.remove()},300*1e3)}var K,Ut,Wt,V,Qt,Q,Kt,u,v,yt,ht,vt=S(()=>{pt();K={path:"/service-worker.js",scope:"/",updateCheckInterval:300*1e3};typeof navigator<"u"&&"serviceWorker"in navigator&&gt();Ut=(t,r=100)=>{let s=new Map;return(...m)=>{let d=JSON.stringify(m);if(s.has(d))return s.get(d);let f=t(...m);if(s.size>=r){let g=s.keys().next().value;s.delete(g)}return s.set(d,f),f}},Wt=(t,r)=>{let s;return(...m)=>{clearTimeout(s),s=setTimeout(()=>t(...m),r)}},V=t=>{if(!t)return"";try{return String(t).normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9]/g,"").toLowerCase()}catch{return String(t).toLowerCase()}},Qt=t=>{let r=`${t.name}-${t.category}`.toLowerCase(),s=0;for(let m=0;m<r.length;m++){let d=r.charCodeAt(m);s=(s<<5)-s+d,s=s&s}return`pid-${Math.abs(s)}`},Q=t=>{let r=document.createElement("div");return r.textContent=t,r.innerHTML},Kt=async()=>{try{let t=localStorage.getItem("productDataVersion"),r=t?`/_products/product_data.json?v=${encodeURIComponent(t)}`:"/_products/product_data.json",s=await fetch(r,{cache:"no-store",headers:{Accept:"application/json"}});if(!s.ok)throw new Error(`HTTP error. Status: ${s.status}`);return(await s.json()).products.map(d=>({...d,id:Qt(d),name:Q(d.name),description:Q(d.description),category:Q(d.category),categoryKey:V(d.category)}))}catch(t){throw console.error("Error al obtener productos:",t),v(`Error al cargar los productos. Por favor, verifique su conexi\xF3n a internet e int\xE9ntelo de nuevo. (Error: ${t.message})`),t}},u=(t,r={},s=[])=>{let m=document.createElement(t);return Object.entries(r).forEach(([d,f])=>{d==="text"?m.textContent=f:m.setAttribute(d,f)}),s.forEach(d=>{typeof d=="string"?m.appendChild(document.createTextNode(d)):m.appendChild(d)}),m},v=t=>{let r=u("div",{class:"error-message",role:"alert"},[u("p",{},[t]),u("button",{class:"retry-button"},["Intentar nuevamente"])]),s=document.getElementById("product-container");s?(s.innerHTML="",s.appendChild(r),r.querySelector(".retry-button").addEventListener("click",ht)):console.error("Contenedor de productos no encontrado")},yt=[];try{yt=JSON.parse(globalThis.localStorage?.getItem("cart"))||[]}catch{yt=[]}typeof window<"u"&&(window.__APP_READY__=!1,window.addEventListener("error",t=>{let r=t.target||t.srcElement,s=!!(r&&(r.tagName==="IMG"||r.tagName==="SCRIPT"||r.tagName==="LINK")),m=!!t.error;if(s||!m){console.warn("Ignored non-fatal error:",{tag:r&&r.tagName,src:r&&(r.src||r.href||r.currentSrc)});return}if(!window.__APP_READY__){console.error("Runtime error before app ready:",t.error);return}console.error("Unhandled JS error:",t.error),v("Ocurri\xF3 un error inesperado. Por favor, recarga la p\xE1gina.")}),window.addEventListener("securitypolicyviolation",t=>{console.warn("CSP violation (logged only):",{blockedURI:t.blockedURI,violatedDirective:t.violatedDirective,sourceFile:t.sourceFile})}));ht=async()=>{if(console.log("Initializing app..."),typeof DOMPurify>"u")try{await new Promise((e,o)=>{let a=document.createElement("script");a.src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/2.3.8/purify.min.js",a.integrity="sha384-AsiVBlzbaNOq8OOKcXm2ZVjjKJwiQ9UmzLwfetDjC74OMQdkb6vBHH5QRJH3x1SE",a.crossOrigin="anonymous",a.onload=e,a.onerror=o,document.head.appendChild(a)})}catch{console.warn("DOMPurify CDN blocked; using noop sanitizer"),window.DOMPurify={sanitize:o=>o}}let t=document.getElementById("navbar-container"),r=document.getElementById("footer-container"),s=document.getElementById("product-container"),m=document.getElementById("sort-options"),d=document.getElementById("filter-keyword"),f=()=>{let e=document.getElementById("filter-discount");if(e)return e;let o=document.querySelector('section[aria-label*="filtrado"], section[aria-label*="Opciones de filtrado"]'),a=o?o.querySelector(".row"):null;if(!a)return null;let i=u("div",{class:"col-12 mt-2"}),n=u("div",{class:"form-check form-switch"}),c=u("input",{class:"form-check-input",type:"checkbox",id:"filter-discount","aria-label":"Mostrar solo productos con descuento"}),l=u("label",{class:"form-check-label",for:"filter-discount"},["Solo productos con descuento"]);return n.appendChild(c),n.appendChild(l),i.appendChild(n),a.appendChild(i),c},g=[],y=JSON.parse(localStorage.getItem("cart"))||[],j=()=>{let e=document.getElementById("offline-indicator");if(e){let o=navigator.onLine;e.classList.toggle("is-hidden",o),e.style.display=o?"none":"block"}navigator.onLine||console.log("App is offline. Using cached data if available.")},Y=async(e,o)=>{if(!e){console.warn(`Contenedor no encontrado para el componente: ${o}`);return}try{let a=await fetch(o);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);let i=await a.text(),n=DOMPurify.sanitize(i,{USE_PROFILES:{html:!0},ALLOWED_TAGS:["div","span","p","h1","h2","h3","h4","h5","h6","ul","ol","li","a","img","br","strong","em","button","nav","footer","header","main","section"],ALLOWED_ATTR:["href","src","alt","class","id","style","aria-label","role","type","data-bs-toggle","data-bs-target","aria-controls","aria-expanded"]});e.innerHTML="";let l=new DOMParser().parseFromString(n,"text/html");Array.from(l.body.children).forEach(p=>{e.appendChild(p.cloneNode(!0))})}catch(a){throw console.error("Error al cargar componente:",{component:o,message:a.message}),a}};function wt(){let e=document.getElementById("current-year");e&&(e.textContent=new Date().getFullYear())}let Ct=async()=>{try{await Promise.all([Y(t,"/pages/navbar.html"),Y(r,"/pages/footer.html")]),console.log("Components loaded successfully"),wt()}catch(e){console.error("Error al cargar componentes:",e),v("Error al cargar los componentes de la p\xE1gina. Por favor, actualice la p\xE1gina o verifique su conexi\xF3n a internet.")}},Et=(e,o,a="CLP")=>{let i=new Intl.NumberFormat("es-CL",{style:"currency",currency:a,minimumFractionDigits:0}),n=i.format(e);if(o){let c=e-o,l=i.format(c);return u("div",{class:"precio-container"},[u("span",{class:"precio-descuento","aria-label":"Precio con descuento"},[l]),u("span",{class:"precio-original","aria-label":"Precio original"},[u("span",{class:"tachado"},[n])])])}return u("div",{class:"precio-container"},[u("span",{class:"precio","aria-label":"Precio"},[n])])},St=e=>{let o=u("div",{class:"quantity-control"}),a=u("button",{class:"quantity-btn","aria-label":"Decrease quantity"},["-"]),i=u("button",{class:"quantity-btn","aria-label":"Increase quantity"},["+"]),n=u("input",{type:"number",class:"quantity-input",value:Math.max(R(e.id),1),min:"1",max:"50","aria-label":"Quantity","data-id":e.id});return a.addEventListener("click",()=>x(e,-1)),i.addEventListener("click",()=>x(e,1)),n.addEventListener("change",c=>{let l=parseInt(c.target.value,10),p=R(e.id);x(e,l-p)}),o.appendChild(a),o.appendChild(n),o.appendChild(i),o},R=e=>{let o=y.find(a=>a.id===e);return o?o.quantity:0},Lt=e=>{let o=document.createDocumentFragment();e.forEach(i=>{let{id:n,name:c,description:l,image_path:p,price:L,discount:_,stock:U}=i,M=u("div",{class:`producto col-12 col-sm-6 col-md-4 col-lg-3 mb-4 ${U?"":"agotado"}`,"aria-label":`Product: ${c}`}),q=u("div",{class:"card"});if(_&&Number(_)>0){let I=Math.round(Number(_)/Number(L)*100),D=u("span",{class:"discount-badge badge bg-danger","aria-label":"Producto en oferta"},[`-${isFinite(I)?I:0}%`]);q.appendChild(D)}let A=`/${p.replace(/^\//,"")}`,$=u("img",{src:z(A,{...B,width:200}),srcset:[`${z(A,{...B,width:200,dpr:1})} 1x`,`${z(A,{...B,width:200,dpr:2})} 2x`].join(", "),alt:c,class:"card-img-top product-thumb",loading:"lazy",decoding:"async",width:"200",height:"200"});q.appendChild($);let b=u("div",{class:"card-body"});b.appendChild(u("h3",{class:"card-title"},[c])),b.appendChild(u("p",{class:"card-text"},[l])),b.appendChild(Et(L,_));let N=u("div",{class:"action-area","data-pid":n}),C=u("button",{class:"btn btn-primary add-to-cart-btn mt-2","data-id":n,"aria-label":`Add ${c} to cart`},["Agregar al carrito"]),E=St(i);E.style.display="none",C.addEventListener("click",()=>{Z(i,1),O(C,E,!0)}),N.appendChild(C),N.appendChild(E),b.appendChild(N);let w=y.find(I=>I.id===n),h=w?w.quantity:0,W=E.querySelector(".quantity-input");h>0?(W&&(W.value=h),C.style.display="none",E.style.display="flex"):(C.style.display="flex",E.style.display="none"),q.appendChild(b),M.appendChild(q),o.appendChild(M)});let a=document.getElementById("product-container");a.innerHTML="",a.appendChild(o),It()},It=()=>{let e=new IntersectionObserver((o,a)=>{o.forEach(i=>{if(i.isIntersecting){let n=i.target;n.src=n.dataset.src,n.dataset.srcset&&(n.srcset=n.dataset.srcset),n.dataset.sizes&&(n.sizes=n.dataset.sizes),n.classList.remove("lazyload"),a.unobserve(n)}})},{rootMargin:"100px"});document.querySelectorAll("img.lazyload").forEach(o=>e.observe(o))};function Pt(e,o){if(!e||!o||e.length<3)return!1;let a=c=>c.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim(),i=a(e),n=a(o);return n.includes(i)?!0:i.length>=4?_t(i,n):!1}function _t(e,o){return o.split(/\s+/).some(i=>{if(Math.abs(i.length-e.length)>1)return!1;let n=0,c=Math.max(i.length,e.length);if(Math.min(i.length,e.length)<4)return!1;if(i.length===e.length){for(let p=0;p<i.length;p++)if(i[p]!==e[p]&&n++,n>1)return!1;return n===1}else return qt(e,i)})}function qt(e,o){let a=e.length>o.length?e:o,i=e.length>o.length?o:e;if(a.length-i.length!==1)return!1;let n=0,c=0,l=0;for(;c<i.length&&l<a.length;)if(i[c]===a[l])c++,l++;else{if(n++,n>1)return!1;l++}return!0}let kt=(e,o,a,i=!1)=>{let n=o.trim();return e.filter(c=>!c.stock||i&&!(c.discount&&Number(c.discount)>0)?!1:!n||c.name.toLowerCase().includes(n.toLowerCase())||c.description.toLowerCase().includes(n.toLowerCase())?!0:n.length>=4?Pt(n,c.name):!1).sort((c,l)=>xt(c,l,a))},xt=(e,o,a)=>{if(!a||a==="original")return e.originalIndex-o.originalIndex;let[i,n]=a.split("-"),c=i==="price"?e.price-(e.discount||0):e.name.toLowerCase(),l=i==="price"?o.price-(o.discount||0):o.name.toLowerCase();return n==="asc"?c<l?-1:c>l?1:0:l<c?-1:l>c?1:0},At=Ut(kt),F=()=>{try{let e=m.value||"original",o=d.value.trim(),a=document.getElementById("filter-discount")?.checked||!1,i=At(g,o,e,a);Lt(i)}catch(e){console.error("Error al actualizar visualizaci\xF3n de productos:",e),v("Error al actualizar la visualizaci\xF3n de productos. Por favor, intenta m\xE1s tarde.")}},H=Wt(F,300),k=()=>{let e=document.getElementById("cart-count"),o=y.reduce((a,i)=>a+i.quantity,0);e.textContent=o,e.setAttribute("aria-label",`${o} items in cart`)},Z=(e,o)=>{try{let a=y.find(n=>n.id===e.id);a?a.quantity=Math.min(a.quantity+o,50):y.push({id:e.id,name:e.name,description:e.description,price:e.price,discount:e.discount,image_path:e.image_path,quantity:Math.min(o,50),category:e.category,stock:e.stock}),T(),k(),P();let i=document.querySelector(`[data-id="${e.id}"].quantity-input`);i&&(i.value=Math.max(R(e.id),1))}catch(a){console.error("Error al agregar al carrito:",a),v("Error al agregar el art\xEDculo al carrito. Por favor, intenta nuevamente.")}},X=e=>{try{y=y.filter(a=>a.id!==e),T(),k(),P();let o=document.querySelector(`.action-area[data-pid="${e}"]`);if(o){let a=o.querySelector(".add-to-cart-btn"),i=o.querySelector(".quantity-control");O(a,i,!1)}}catch(o){console.error("Error al eliminar del carrito:",o),v("Error al eliminar el art\xEDculo del carrito. Por favor, intenta nuevamente.")}},x=(e,o)=>{try{let a=y.find(p=>p.id===e.id),i=a?a.quantity+o:1,n=document.querySelector(`.action-area[data-pid="${e.id}"]`),c=n?.querySelector(".add-to-cart-btn"),l=n?.querySelector(".quantity-control");if(i<=0)X(e.id),O(c,l,!1);else if(i<=50){a?a.quantity=i:(Z(e,1),O(c,l,!0)),T(),k(),P();let p=document.querySelector(`[data-id="${e.id}"].quantity-input`);p&&(p.value=i,p.classList.add("quantity-changed"),setTimeout(()=>p.classList.remove("quantity-changed"),300))}}catch(a){console.error("Error al actualizar cantidad:",a),v("Error al actualizar la cantidad. Por favor, intenta nuevamente.")}},$t=()=>{try{y=[],T(),k(),P(),F()}catch(e){console.error("Error al vaciar el carrito:",e),v("Error al vaciar el carrito. Por favor, int\xE9ntelo de nuevo.")}},O=(e,o,a)=>{!e||!o||(a?(e.style.display="none",o.style.display="flex"):(o.style.display="none",e.style.display="flex"))},T=()=>{try{localStorage.setItem("cart",JSON.stringify(y))}catch(e){console.error("Error al guardar el carrito:",e),v("Error al guardar el carrito. Tus cambios podr\xEDan no persistir.")}},P=()=>{let e=document.getElementById("cart-items"),o=document.getElementById("cart-total");e.innerHTML="";let a=0;y.forEach(n=>{let c=n.price-(n.discount||0),l=u("div",{class:"cart-item mb-3 d-flex align-items-start","aria-label":`Cart item: ${n.name}`}),p=u("div",{class:"cart-item-content flex-grow-1"});p.appendChild(u("div",{class:"fw-bold mb-1"},[n.name]));let L=u("div",{class:"mb-2"}),_=u("button",{class:"btn btn-sm btn-secondary decrease-quantity","data-id":n.id,"aria-label":`Disminuir cantidad de ${n.name}`},["-"]),U=u("button",{class:"btn btn-sm btn-secondary increase-quantity","data-id":n.id,"aria-label":`Aumentar cantidad de ${n.name}`},["+"]),M=u("span",{class:"mx-2 item-quantity","aria-label":`Cantidad de ${n.name}`},[n.quantity.toString()]);L.appendChild(_),L.appendChild(M),L.appendChild(U),p.appendChild(L),p.appendChild(u("div",{class:"text-muted small"},[`Precio: $${c.toLocaleString("es-CL")}`])),p.appendChild(u("div",{class:"fw-bold"},[`Subtotal: $${(c*n.quantity).toLocaleString("es-CL")}`]));let q=u("button",{class:"btn btn-sm btn-danger remove-item mt-2","data-id":n.id,"aria-label":`Eliminar ${n.name} del carrito`},["Eliminar"]);p.appendChild(q);let A=window.location.pathname.includes("/pages/"),$;A?$=`../${n.image_path.replace(/^\//,"")}`:$=n.image_path;let b=u("div",{class:"cart-item-thumb ms-3 flex-shrink-0"}),C={src:n.thumbnail_path||$,alt:n.name,class:"cart-item-thumb-img",loading:"lazy",decoding:"async",width:"100",height:"100"};if(Array.isArray(n.thumbnail_variants)){let w=n.thumbnail_variants.filter(h=>h&&h.url&&h.width).map(h=>`${h.url} ${h.width}w`);w.length&&(C.srcset=w.join(", "),C.sizes="100px")}let E=u("img",C);if(b.appendChild(E),l.appendChild(p),l.appendChild(b),e.appendChild(l),window.__DEBUG_CART__)try{let w=window.getComputedStyle(l),h=window.getComputedStyle(b),W=window.getComputedStyle(p),I=b.getBoundingClientRect(),D=p.getBoundingClientRect();console.debug("[cart] item",{name:n.name,order:{firstIsContent:l.firstChild===p,lastIsThumb:l.lastChild===b},container:{display:w.display,flexDirection:w.flexDirection,flexWrap:w.flexWrap},thumb:{width:h.width,height:h.height,rect:{w:I.width,h:I.height}},content:{rect:{w:D.width,h:D.height}}})}catch{}a+=c*n.quantity}),o.textContent=`Total: $${a.toLocaleString("es-CL")}`,o.setAttribute("aria-label",`Total: $${a.toLocaleString("es-CL")}`);let i=document.getElementById("payment-credit-container");if(i)if(a>=3e4)i.classList.remove("d-none");else{i.classList.add("d-none");let n=i.querySelector("input");n&&(n.checked=!1)}},Ot=()=>{let e=document.querySelector('input[name="paymentMethod"]:checked');if(!e){alert("Por favor seleccione un m\xE9todo de pago");return}let o=`Mi pedido:

`;y.forEach(n=>{let c=n.price-(n.discount||0);o+=`${n.name}
`,o+=`Cantidad: ${n.quantity}
`,o+=`Precio unitario: $${c.toLocaleString("es-CL")}
`,o+=`Subtotal: $${(c*n.quantity).toLocaleString("es-CL")}

`});let a=y.reduce((n,c)=>n+(c.price-(c.discount||0))*c.quantity,0);o+=`Total: $${a.toLocaleString("es-CL")}
`,o+=`M\xE9todo de pago: ${e.value}`;let i=encodeURIComponent(o);window.open(`https://wa.me/56951118901?text=${i}`,"_blank")};try{if(await Ct(),g=await Kt(),g.length===0){v("No hay productos disponibles. Por favor, intenta m\xE1s tarde.");return}let e=document.querySelector("main").dataset.category;if(e){let c=V(e);g=g.filter(l=>(l.categoryKey||V(l.category))===c)}m.addEventListener("change",H),d.addEventListener("input",H);let o=f();o&&o.addEventListener("change",H),F(),typeof window<"u"&&(window.__APP_READY__=!0),window.addEventListener("online",j),window.addEventListener("offline",j),j();let a=document.getElementById("cart-icon"),i=document.getElementById("empty-cart"),n=document.getElementById("submit-cart");a.addEventListener("click",()=>{if(typeof window.bootstrap<"u"&&window.bootstrap.Offcanvas){let c=new window.bootstrap.Offcanvas(document.getElementById("cartOffcanvas"));P(),c.show()}else{console.error("Bootstrap Offcanvas no est\xE1 disponible"),P();let c=document.getElementById("cartOffcanvas");c&&c.classList.add("show")}}),i.addEventListener("click",$t),n.addEventListener("click",Ot),document.getElementById("cart-items").addEventListener("click",c=>{let l=c.target,p=l.closest("[data-id]")?.dataset.id;p&&(l.classList.contains("decrease-quantity")?x({id:p},-1):l.classList.contains("increase-quantity")?x({id:p},1):l.classList.contains("remove-item")&&X(p))}),k(),"performance"in window&&window.addEventListener("load",()=>{let c=performance.getEntriesByType("paint"),l=performance.getEntriesByType("navigation")[0];console.log("First Contentful Paint:",c[0].startTime),console.log("DOM Content Loaded:",l.domContentLoadedEventEnd),console.log("Load Time:",l.loadEventEnd)})}catch(e){console.error("Error al inicializar productos:",e),v("Error al cargar productos. Por favor, int\xE9ntelo m\xE1s tarde.")}};typeof document<"u"&&document.addEventListener("DOMContentLoaded",function(){gt(),ht().catch(t=>{console.error("Error al inicializar la aplicaci\xF3n:",t),v("Error al inicializar la aplicaci\xF3n. Por favor, actualice la p\xE1gina.")})})});var Vt=Tt(()=>{et();ot();rt();st();dt();mt();vt();function bt(){let t=document.documentElement;try{document.querySelectorAll('link[rel="stylesheet"][media="print"][data-defer]').forEach(r=>{r.media="all",r.removeAttribute("data-defer")})}catch{}t.dataset.enhancementsInit!=="1"&&(t.dataset.enhancementsInit="1",tt(),ut(),nt(),at(),ct(),it(),lt())}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",bt):bt()});Vt();})();
